exports.__esModule=!0;exports.default=tokenizer;var SINGLE_QUOTE=39,DOUBLE_QUOTE=34,BACKSLASH=92,SLASH=47,NEWLINE=10,SPACE=32,FEED=12,TAB=9,CR=13,OPEN_SQUARE=91,CLOSE_SQUARE=93,OPEN_PARENTHESES=40,CLOSE_PARENTHESES=41,OPEN_CURLY=123,CLOSE_CURLY=125,SEMICOLON=59,ASTERISK=42,COLON=58,AT=64,RE_AT_END=/[ \n\t\r\f{}()'"\\;/[\]#]/g,RE_WORD_END=/[ \n\t\r\f(){}:;@!'"\\\][#]|\/(?=\*)/g,RE_BAD_BRACKET=/.[\\/("'\n]/,RE_HEX_ESCAPE=/[a-f0-9]/i;
function tokenizer(A,w){function x(a){throw A.error("Unclosed "+a,d,b-f);}void 0===w&&(w={});var c=A.css.valueOf(),y=w.ignoreErrors,e,a,B,r,k,l,u,m,n,p,t,C,q,g,D=c.length,f=-1,d=1,b=0,z=[],v=[];return{back:function(a){v.push(a)},nextToken:function(h){if(v.length)return v.pop();if(!(b>=D)){h=h?h.ignoreUnclosed:!1;e=c.charCodeAt(b);if(e===NEWLINE||e===FEED||e===CR&&c.charCodeAt(b+1)!==NEWLINE)f=b,d+=1;switch(e){case NEWLINE:case SPACE:case TAB:case CR:case FEED:a=b;do a+=1,e=c.charCodeAt(a),e===NEWLINE&&
(f=a,d+=1);while(e===SPACE||e===NEWLINE||e===TAB||e===CR||e===FEED);g=["space",c.slice(b,a)];b=a-1;break;case OPEN_SQUARE:case CLOSE_SQUARE:case OPEN_CURLY:case CLOSE_CURLY:case COLON:case SEMICOLON:case CLOSE_PARENTHESES:h=String.fromCharCode(e);g=[h,h,d,b-f];break;case OPEN_PARENTHESES:C=z.length?z.pop()[1]:"";q=c.charCodeAt(b+1);if("url"===C&&q!==SINGLE_QUOTE&&q!==DOUBLE_QUOTE&&q!==SPACE&&q!==NEWLINE&&q!==TAB&&q!==FEED&&q!==CR){a=b;do{p=!1;a=c.indexOf(")",a+1);if(-1===a)if(y||h){a=b;break}else x("bracket");
for(t=a;c.charCodeAt(t-1)===BACKSLASH;)--t,p=!p}while(p);g=["brackets",c.slice(b,a+1),d,b-f,d,a-f];b=a}else a=c.indexOf(")",b+1),l=c.slice(b,a+1),-1===a||RE_BAD_BRACKET.test(l)?g=["(","(",d,b-f]:(g=["brackets",l,d,b-f,d,a-f],b=a);break;case SINGLE_QUOTE:case DOUBLE_QUOTE:B=e===SINGLE_QUOTE?"'":'"';a=b;do{p=!1;a=c.indexOf(B,a+1);if(-1===a)if(y||h){a=b+1;break}else x("string");for(t=a;c.charCodeAt(t-1)===BACKSLASH;)--t,p=!p}while(p);l=c.slice(b,a+1);r=l.split("\n");k=r.length-1;0<k?(m=d+k,n=a-r[k].length):
(m=d,n=f);g=["string",c.slice(b,a+1),d,b-f,m,a-n];f=n;d=m;b=a;break;case AT:RE_AT_END.lastIndex=b+1;RE_AT_END.test(c);a=0===RE_AT_END.lastIndex?c.length-1:RE_AT_END.lastIndex-2;g=["at-word",c.slice(b,a+1),d,b-f,d,a-f];b=a;break;case BACKSLASH:a=b;for(u=!0;c.charCodeAt(a+1)===BACKSLASH;)a+=1,u=!u;e=c.charCodeAt(a+1);if(u&&e!==SLASH&&e!==SPACE&&e!==NEWLINE&&e!==TAB&&e!==CR&&e!==FEED&&(a+=1,RE_HEX_ESCAPE.test(c.charAt(a)))){for(;RE_HEX_ESCAPE.test(c.charAt(a+1));)a+=1;c.charCodeAt(a+1)===SPACE&&(a+=
1)}g=["word",c.slice(b,a+1),d,b-f,d,a-f];b=a;break;default:e===SLASH&&c.charCodeAt(b+1)===ASTERISK?(a=c.indexOf("*/",b+2)+1,0===a&&(y||h?a=c.length:x("comment")),l=c.slice(b,a+1),r=l.split("\n"),k=r.length-1,0<k?(m=d+k,n=a-r[k].length):(m=d,n=f),g=["comment",l,d,b-f,m,a-n],f=n,d=m):(RE_WORD_END.lastIndex=b+1,RE_WORD_END.test(c),a=0===RE_WORD_END.lastIndex?c.length-1:RE_WORD_END.lastIndex-2,g=["word",c.slice(b,a+1),d,b-f,d,a-f],z.push(g)),b=a}b++;return g}},endOfFile:function(){return 0===v.length&&
b>=D},position:function(){return b}}}module.exports=exports.default;
